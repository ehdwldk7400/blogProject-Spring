<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.jin.dao.ReplyDAO">

	<select id="list" resultType="com.jin.doamin.ReplyVO">
		 	<![CDATA[
		 		select * from post_reply where bno=#{bno} and rno > 0 order by rno desc; 
		 	]]>
	</select>
	
	<select id="replycnt" resultType="int">
			select count(*) from post_reply where bno = #{bno};
	</select>
	
	<insert id="rePlycreate">
		insert into post_reply(bno, replytext, replyer, open) values(#{bno}, #{replytext}, #{replyer}, #{open})
	</insert>
	
	<delete id="delete">
 		delete from post_reply where rno = #{rno};
 	</delete>
 	
 	<update id="update">
 		update post_reply set replytext = #{replytext}, open = #{open} where rno = #{rno};
 	</update>
 	
 	<select id="listPage" resultType="com.jin.doamin.ReplyVO">
 		<![CDATA[
	 		select * from (
					select @rownum:=@rownum+1 as rownum, b.* 
					from (select @rownum:=0) as tmp, post_reply as b 
					where bno = 161
			 		order by rno desc
				) post_reply
				where rownum > (#{cri.pageNum}-1)* #{cri.amount} 
					and rownum <= #{cri.pageNum} * #{cri.amount}
		]]>
 	</select>

</mapper>